package de.afrouper.cve;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class CommandLineParserTest {

    @Test
    void parameters() {
        String[] args = new String[]{"-cve", "CVE-2022-4711", "/home/user/files"};

        CommandLineParser commandLineParser = new CommandLineParser(args);
        Assertions.assertEquals("CVE-2022-4711", commandLineParser.getCve());
        Assertions.assertEquals("/home/user/files", commandLineParser.getPath());
    }

    @Test
    void nullCase() {
        Exception exception = assertThrows(NullPointerException.class, () ->
                new CommandLineParser(null));
        assertEquals("Arguments cannot be null!", exception.getMessage());
    }

    @Test
    void someMissing() {
        String[] args = new String[]{"/home/user/files"};

        CommandLineParser commandLineParser = new CommandLineParser(args);
        Assertions.assertNull(commandLineParser.getCve());
        Assertions.assertEquals("/home/user/files", commandLineParser.getPath());
    }

    @Test
    void pathMissing() {
        String[] args = new String[]{"-cve", "CVE-2022-4711"};

        CommandLineParser commandLineParser = new CommandLineParser(args);
        Assertions.assertNull(commandLineParser.getPath());
        Assertions.assertEquals("CVE-2022-4711", commandLineParser.getCve());
    }
}